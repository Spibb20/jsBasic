<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Object</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@1.0.4/css/bulma.min.css"
    />
  </head>
  <body>
    <div class="buttons">
      <button class="button" onclick="printAll()">All Students</button>
      <button class="button" onclick="calcAdult()">Adult Students</button>
      <button class="button" onclick="searchy()">Search</button>
    </div>
    <div class="table-container">
      <table
        class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth"
      >
        <thead>
          <tr>
            <th>#</th>
            <th></th>
            <th>Name</th>
            <th>
              <button onclick="ageSorting()">Age</button>
            </th>
            <th>Email</th>
            <th>Username</th>
            <th>Phone</th>
            <th>gender</th>
            <th>Hobbies</th>
            <th>Scores</th>
            <th>Avg</th>
            <th>Last Logged</th>
          </tr>
        </thead>
        <tbody id="tableBody"></tbody>
      </table>
    </div>
    <script>
      const students = [
        {
          овог: "Батсүхийн",
          нэр: "Энхболд",
          нас: 28,
          email: "enkhbold.b@domain.mn",
          утас: "99112233",
          хүйс: "эрэгтэй",
          hobbies: ["шатар", "ном унших"],
          scores: [85, 92, 78],
          lastLogged: 1723578294000,
        },
        {
          овог: "Санжжавын",
          нэр: "Түмэнжаргал",
          нас: 35,
          email: "tumenjargal.s@domain.mn",
          утас: "99001122",
          хүйс: "эрэгтэй",
          hobbies: ["дугуй унах", "зурах"],
          scores: [88, 91, 79],
          lastLogged: 1726011203000,
        },
        {
          овог: "Ганхуягийн",
          нэр: "Баярмаа",
          нас: 31,
          email: "bayarmaa.g@domain.mn",
          утас: "88117766",
          хүйс: "эмэгтэй",
          hobbies: ["жигнэмэг хийх", "аялах"],
          scores: [92, 87, 80],
          lastLogged: 1724816600000,
        },
        {
          овог: "Чулуунбаатарын",
          нэр: "Отгонжаргал",
          нас: 27,
          email: "otgonjargal.ch@domain.mn",
          утас: "95124567",
          хүйс: "эмэгтэй",
          hobbies: ["ногоо тарих", "кино үзэх"],
          scores: [81, 90, 75],
          lastLogged: 1725830032000,
        },
        {
          овог: "Доржсүрэнгийн",
          нэр: "Мөнхбаяр",
          нас: 40,
          email: "munkhbayar.d@domain.mn",
          утас: "99008877",
          хүйс: "эрэгтэй",
          hobbies: ["загас барих", "биллярд"],
          scores: [89, 93, 84],
          lastLogged: 1724297854000,
        },
        {
          овог: "Сүхбаатарын",
          нэр: "Ганзориг",
          нас: 33,
          email: "ganzorig.s@domain.mn",
          утас: "80223344",
          хүйс: "эрэгтэй",
          hobbies: ["шатар", "ууланд алхах"],
          scores: [90, 85, 77],
          lastLogged: 1724982300000,
        },
        {
          овог: "Цогтбаатарын",
          нэр: "Хишигжаргал",
          нас: 29,
          email: "khishigjargal.ts@domain.mn",
          утас: "95119900",
          хүйс: "эмэгтэй",
          hobbies: ["ном унших", "бялуу хийх"],
          scores: [86, 88, 81],
          lastLogged: 1726139938000,
        },
        {
          овог: "Мөнхбатын",
          нэр: "Сарантуяа",
          нас: 38,
          email: "sarantuya.m@domain.mn",
          утас: "88001234",
          хүйс: "эмэгтэй",
          hobbies: ["зураг авах", "дурсамж бичих"],
          scores: [94, 89, 83],
          lastLogged: 1725023400000,
        },
        {
          овог: "Баярсайханы",
          нэр: "Отгонбаяр",
          нас: 36,
          email: "otgonbayar.b@domain.mn",
          утас: "98112255",
          хүйс: "эрэгтэй",
          hobbies: ["спорт тоглох", "ном унших"],
          scores: [87, 91, 76],
          lastLogged: 1723855442000,
        },
        {
          овог: "Эрдэнэбатын",
          нэр: "Болортуяа",
          нас: 26,
          email: "bolortuya.e@domain.mn",
          утас: "90001122",
          хүйс: "эмэгтэй",
          hobbies: ["будаа хийх", "аялах"],
          scores: [84, 90, 78],
          lastLogged: 1725244456000,
        },
        {
          овог: "Батмөнхийн",
          нэр: "Энхтуяа",
          нас: 30,
          email: "enkhtuya.bm@domain.mn",
          утас: "95223344",
          хүйс: "эмэгтэй",
          hobbies: ["зураг зурах", "ном унших"],
          scores: [83, 95, 82],
          lastLogged: 1725733388000,
        },
        {
          овог: "Төмөрбаатарын",
          нэр: "Алтангэрэл",
          нас: 45,
          email: "altangerel.t@domain.mn",
          утас: "93112288",
          хүйс: "эрэгтэй",
          hobbies: ["хөлбөмбөг", "аялах"],
          scores: [95, 88, 80],
          lastLogged: 1724312900000,
        },
        {
          овог: "Жамъянгийн",
          нэр: "Мөнхтуул",
          нас: 25,
          email: "munkhtuul.j@domain.mn",
          утас: "88229911",
          хүйс: "эмэгтэй",
          hobbies: ["кино үзэх", "зурах"],
          scores: [87, 84, 79],
          lastLogged: 1726154456000,
        },
        {
          овог: "Лхагвасүрэнгийн",
          нэр: "Баярцэцэг",
          нас: 34,
          email: "bayartsetseg.l@domain.mn",
          утас: "99115577",
          хүйс: "эмэгтэй",
          hobbies: ["шатар", "загас барих"],
          scores: [89, 91, 77],
          lastLogged: 1724927755000,
        },
        {
          овог: "Очирбатын",
          нэр: "Ганбат",
          нас: 39,
          email: "ganbat.o@domain.mn",
          утас: "80001199",
          хүйс: "эрэгтэй",
          hobbies: ["спорт тоглох", "аялах"],
          scores: [90, 85, 82],
          lastLogged: 1724378822000,
        },
        {
          овог: "Даваадоржийн",
          нэр: "Энхжаргал",
          нас: 28,
          email: "enkhjargal.d@domain.mn",
          утас: "95224488",
          хүйс: "эмэгтэй",
          hobbies: ["бялуу хийх", "ногоо тарих"],
          scores: [82, 90, 84],
          lastLogged: 1726061188000,
        },
        {
          овог: "Сэр-Одын",
          нэр: "Мягмарсүрэн",
          нас: 42,
          email: "myagmarsuren.s@domain.mn",
          утас: "99119922",
          хүйс: "эмэгтэй",
          hobbies: ["шатар", "аялах"],
          scores: [93, 88, 86],
          lastLogged: 1725210035000,
        },
        {
          овог: "Ганболдын",
          нэр: "Отгончимэг",
          нас: 26,
          email: "otgonchimeg.g@domain.mn",
          утас: "90115566",
          хүйс: "эмэгтэй",
          hobbies: ["ном унших", "жигнэмэг хийх"],
          scores: [88, 86, 80],
          lastLogged: 1724718233000,
        },
        {
          овог: "Доржпаламын",
          нэр: "Цэцэгмаа",
          нас: 32,
          email: "tsetsegmaa.d@domain.mn",
          утас: "95128899",
          хүйс: "эмэгтэй",
          hobbies: ["кино үзэх", "зурах"],
          scores: [84, 90, 79],
          lastLogged: 1724159900000,
        },
        {
          овог: "Бямбадоржийн",
          нэр: "Сүхбат",
          нас: 29,
          email: "sukhbat.b@domain.mn",
          утас: "99007755",
          хүйс: "эрэгтэй",
          hobbies: ["хөлбөмбөг", "ууланд алхах"],
          scores: [85, 87, 76],
          lastLogged: 1725372244000,
        },
        {
          овог: "Мягмарын",
          нэр: "Наранцэцэг",
          нас: 23,
          email: "narantsetseg.m@domain.mn",
          утас: "99114433",
          хүйс: "эмэгтэй",
          hobbies: ["ном унших", "будаа хийх"],
          scores: [90, 85, 81],
          lastLogged: 1723817722000,
        },
        {
          овог: "Нямдоржийн",
          нэр: "Эрдэнэцэцэг",
          нас: 41,
          email: "erdenetsetseg.n@domain.mn",
          утас: "90225577",
          хүйс: "эмэгтэй",
          hobbies: ["зураг авах", "аялах"],
          scores: [92, 88, 85],
          lastLogged: 1724748899000,
        },
        {
          овог: "Батжаргалын",
          нэр: "Гантуяа",
          нас: 24,
          email: "gantuya.bj@domain.mn",
          утас: "99556677",
          хүйс: "эмэгтэй",
          hobbies: ["жигнэмэг хийх", "кино үзэх"],
          scores: [88, 89, 80],
          lastLogged: 1726114422000,
        },
        {
          овог: "Цэрэндашийн",
          нэр: "Мөнгөнчимэг",
          нас: 37,
          email: "munkhnchimeg.ts@domain.mn",
          утас: "99114488",
          хүйс: "эмэгтэй",
          hobbies: ["шатар", "ном унших"],
          scores: [91, 87, 84],
          lastLogged: 1725166677000,
        },
        {
          овог: "Энхбатын",
          нэр: "Халиун",
          нас: 20,
          email: "khaliun.e@domain.mn",
          утас: "90002211",
          хүйс: "эмэгтэй",
          hobbies: ["спорт тоглох", "зурах"],
          scores: [82, 85, 79],
          lastLogged: 1723945599000,
        },
      ];

      const generateTableRow = (index, student) => {
        const average = () => {
          let sum = student.scores[0];
          for (let j = 1; j < 3; j++) sum += student.scores[j];
          return Math.round(sum / 3);
        };

        function lastLoggedConverter() {
          const date = new Date(student.lastLogged);
          return date.toLocaleString();
        }

        return `
        <tr>
            <td>${`${index + 1}`.padStart(3, 0)}</td>
            <td>${student.овог.charAt(0)}</td>
            <td>${student.нэр}</td>
            <td>${student.нас}</td>
            <td>${student.email}</td>
            <td>${(student.username = student.email
              .trim()
              .toLowerCase()
              .split("@")[0])}</td>
            <td>${student.утас}</td>
            <td>${student.хүйс}</td>
            <td>${student.hobbies}</td>
            <td>${student.scores}</td>
            <td>${(student.avg = average(student.scores))}</td>
            <td>${(student.lastLogged = lastLoggedConverter())}</td>
          </tr>`;
      };

      const printAll = () => {
        renderStudents(students);
      };
      printAll();

      //--------------------------------
      const calcAdult = () => {
        const filteredStudents = students.filter(
          (students) => students.нас >= 30
        );
        renderStudents(filteredStudents);
      };

      const calcMinor = () => {
        const filteredStudents = students.filter(
          (students) => students.нас < 30
        );
        renderStudents(filteredStudents);
      };

      //--------------------------------------------------------

      function searchy() {
        const query = prompt("Search query?");
        let searchedStudents = [];

        for (let i = 0; i < students.length; i++) {
          const lowerName = students[i].нэр.toLowerCase();
          const lowerQuery = query.toLowerCase();
          const lowerEmail = students[i].email.toLowerCase();

          if (
            lowerName.includes(lowerQuery) ||
            lowerEmail.includes(lowerQuery)
          ) {
            searchedStudents.push(students[i]);
          }
        }
        renderStudents(searchedStudents);
      }

      //--------------------------------------------------------

      let clickCounter = 0;
      students.forEach((students, i) => (students.di = i));

      const ageSorting = () => {
        if (clickCounter === 0) {
          students.sort((a, b) => a.нас - b.нас);
          clickCounter = 1;
        } else if (clickCounter === 1) {
          students.sort((a, b) => b.нас - a.нас);
          clickCounter = 2;
        } else {
          students.sort((a, b) => a.di - b.di);
          clickCounter = 0;
        }
        renderStudents(students);
      };

      //------------------------------------------
      function renderStudents(students) {
        document.getElementById("tableBody").innerHTML = students
          .map((student, i) => generateTableRow(i, student))
          .join("");
      }
    </script>
  </body>
</html>
